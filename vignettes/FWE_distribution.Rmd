---
title: "FWE distribution"
author: "Freddy Hernandez"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{How to do stuff}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(RelDists)
```

## Flexible Weibull extension distribution

In this vignette we explore the Flexible Weibull extension distribution. This distribution was proposed by Bebbington, Chin-Diew and Zitikis (2007).

### Probability density function

$$f(x) = \left( \mu+ \frac{\sigma}{x^2} \right) e^{\mu x - \sigma / x} \exp \left( -e^{\mu x - \sigma / x} \right), \quad x > 0,$$   
where $\mu > 0$ and $\sigma > 0$.

Next figure shows possible shapes of the pdf for several values of the parameters.

```{r pdfFWE1, echo=FALSE, message=FALSE}
require(RelDists)
curve(dFWE(x, mu=0.75, sigma=0.5), from=0, to=3, ylim=c(0, 1.7), 
      col="red", ylab="f(x)", las=1)
curve(dFWE(x, mu=2.00, sigma=3.0), col="blue", add=TRUE)
curve(dFWE(x, mu=0.75, sigma=1.3), col="green", add=TRUE)

cap1 <- expression(paste(mu, "=", 0.75, ", ", sigma, "=", 0.5))
cap2 <- expression(paste(mu, "=", 2.00, ", ", sigma, "=", 3.0))
cap3 <- expression(paste(mu, "=", 0.75, ", ", sigma, "=", 1.3))

legend('topright', legend=c(cap1, cap2, cap3), 
       col=c("red", "blue", "green"), lty=c(1, 1, 1), bty="n")
```

### Cumulative density function 

$$F(x) = 1 - \exp[-e^{\mu x - \sigma / x}], \quad x > 0.$$

Next figure shows possible shapes of the cdf.

```{r cumulativeFWE2, echo=FALSE}
curve(pFWE(x, mu=0.75, sigma=0.5), from=0, to=3, col="red",
      ylab="F(x)", las=1)
curve(pFWE(x, mu=2, sigma=3), col="blue", add=TRUE)
curve(pFWE(x, mu=0.75, sigma=1.3), col="green", add=TRUE)

cap1 <- expression(paste(mu, "=", 0.75, ", ", sigma, "=", 0.5))
cap2 <- expression(paste(mu, "=", 2.00, ", ", sigma, "=", 3.0))
cap3 <- expression(paste(mu, "=", 0.75, ", ", sigma, "=", 1.3))

legend('bottomright', legend=c(cap1, cap2, cap3), 
       col=c("red", "blue", "green"), lty=c(1, 1, 1), bty="n")
```

### Hazard function

$$h(x) =  \left( \mu+ \frac\sigma{x^2} \right) e^{\mu x - \sigma / x}, \quad x > 0,$$
