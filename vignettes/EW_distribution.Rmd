---
title: "EW distribution"
author: "Olga Usuga and Freddy Hernandez"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "##"
)
```

## Exponentiated Weibull distribution

In this vignette we explore the family `EW` family to estimate parameters.

The distribution was proposed by Mudholkar and Srivastava (1993) but in this document we used the parameterization given by Almalki and Nadarajah (2014).

The pdf of the EW distribution is:

$$f(x)=\lambda\alpha\theta x^{\theta-1} e^{-\alpha x^{\theta}}
      (1-e^{-\alpha x^{\theta}})^{\lambda-1}, \quad x>0,$$
      
where $\alpha$, $\theta$, $\lambda$ > 0; $\alpha$ is a scale parameter and $\theta$ and $\lambda$ are shape parameters.

For some values of the parameters, the Exponentiated Weibull distribution yiels some known distributions, the next table shows that cases.

|$\alpha$   |  $\lambda$  |   $\theta$  |     *Distribution*               |
|:----------|:----------: | :---------: |   ----------------------------   |
|1          |             |             |      Weibull                     | 
|           |             |        2    |      Generalized Rayleigh (GR)   |
|           |             |        1    |      Generalized Exponential(GE) |
|           |      1      |        1    |      Exponential                 |
|           |      1      |        2    |      Rayleigh                    |
 

The next figure shows possible shapes of the pdf for several values of the parameters:

```{r, densidad1, echo=FALSE, message=F}
require(RelDists)
curve(dEW(x, 5, 0.5, 10), from=0, to=2, las=1,
      ylim=c(0,3), col="red", ylab="Probability density function", las=1)
curve(dEW(x, 0.7, 0.5, 0.15), col="green3", add=T)
curve(dEW(x, 1, 3, 1), col="purple", add=T)

cap1 <- expression(paste(alpha, "=", 5, ", ", theta, "=", 0.5, ", ", lambda, "=", 10))
cap2 <- expression(paste(alpha, "=", 5, ", ", theta, "=", 0.5, ", ", lambda, "=", 10))
cap3 <- expression(paste(alpha, "=", 5, ", ", theta, "=", 0.5, ", ", lambda, "=", 10))

legend(x=1.4, y=3.0, 
       legend=c(cap1, cap2, cap3), 
       col=c("red", "green3", "purple"), lty=c(1, 1, 1), bty="n")
```   


## 1) Without covariates

### Example from Mudholkar and Srivastava (1993) page 301

```{r density01}
y <- c(0.1, 0.2, 1, 1, 1, 1, 1, 2, 3, 6, 7, 11, 12, 18, 18, 18, 18, 18, 21,
       32, 36, 40, 45, 46, 47, 50, 55, 60, 63, 63, 67, 67, 67, 67, 72, 75, 
       79, 82, 82, 83, 84, 84, 84, 85, 85, 85, 85, 85, 86, 86)

plot(density(y), lwd=2, col='blue3', main='')
rug(y, col='blue3')
```

Unfortunately the next code does not work.

```{r, eval=FALSE}
require(gamlss)
mod <- gamlss(y~1, sigma.fo=~1, nu.fo=~1, family='EW',
              control=gamlss.control(n.cyc=100, trace=FALSE))
```

### Example from Mudholkar and Hutson (1996) page 3077

```{r density02}
y <- c(1460, 4050, 3570, 2060, 1300, 1390, 1720, 6280, 1360, 7440,
       5320, 1400, 3240, 2710, 4520, 4840, 8320, 13900, 71500, 6250,
       2260, 318, 1330, 970, 1920, 15100, 2870, 20600, 3810, 726,
       7500, 7170, 2000, 829, 17300, 4740, 13400, 1940, 5660)
plot(density(y), lwd=2, col='blue3', main='')
```

Unfortunately the next code does not work.

```{r, eval=FALSE}
require(gamlss)
mod <- gamlss(y~1, sigma.fo=~1, nu.fo=~1, family='EW',
              control=gamlss.control(n.cyc=100, trace=FALSE))
```

### Using simulated data
First, we simulate 100 values for the distribution using known parameters.

```{r}
y <- rEW(n=100, mu=2.0, sigma=1.5, nu=0.5)
```

Next figure shows the density for the `y` vector.

```{r density03, echo=FALSE}
plot(density(y), lwd=2, col='blue3', main='')
rug(y, col='blue3')
```

Now we use the `gamlss` function from __gamlss__ package to estimate the parameters.

```{r, message=FALSE}
require(gamlss)
mod <- gamlss(y~1, sigma.fo=~1, nu.fo=~1, family='EW',
              control=gamlss.control(n.cyc=250, trace=FALSE))
```

To obtain the fitted values for $\mu$, $\sigma$ and $\nu$ we use the inverse link function $\log()$.

```{r}
exp(coef(mod, what='mu'))
exp(coef(mod, what='sigma'))
exp(coef(mod, what='nu'))
```

The results show that estimated parameters are close the true parameters $\mu$, $\sigma$ and $\nu$.



## 2) With covariates
Here ...
