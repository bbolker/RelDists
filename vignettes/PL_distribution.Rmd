---
title: "PL distribution"
author: "Amylkar Urrea"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{PL distribution}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "##"
)
```

## Power Lindley distribution

In this vignette we explore the Power Lindley distribution.

The distribution was proposed by Ghitanya (2013).

### Probability density function

$$f(x) = \frac{\mu \sigma^2}{\sigma + 1} (1 + x^\mu) x ^ {\mu - 1} 
\exp({-\sigma x ^\mu}), \quad x>0,$$
      
where $\mu$, $\sigma$ > 0; $\mu$ is a shape parameter and $\sigma$ is a scale parameter.

Next figure shows possible shapes of the probability density function for several values of the parameters:

```{r, PL1, echo=FALSE, message=FALSE}
library(RelDists)
curve(dPL(x, mu=1, sigma=0.5), from=0.001, to=12, las=1, xlab='Density',
      ylim=c(0,0.6), col="red", ylab="f(x)", las=1)
curve(dPL(x, mu=1.5, sigma=0.2), col="green3", add=TRUE)
curve(dPL(x, mu=0.8, sigma=2), col="purple", add=TRUE)

cap1 <- expression(paste(mu, "=", 1, ", ", sigma, "=", 0.5))
cap2 <- expression(paste(mu, "=", 1.5, ", ", sigma, "=", 0.2))
cap3 <- expression(paste(mu, "=", 0.8, ", ", sigma, "=", 2))

legend('topright', legend=c(cap1, cap2, cap3), 
       col=c("red", "green3", "purple"), lty=c(1, 1, 1), bty="n")
```

### Cumulative density function

$$F(x) = 1 - (1 + \frac{\sigma x^\mu}{\sigma + 1} ) \exp({-\sigma x ^\mu}), \quad x > 0.$$

Next figure shows possible shapes of the cdf.

```{r, PL2, echo=FALSE}
curve(pPL(x, mu=1, sigma=0.5), from=0.001, to=12, las=1, xlab='Density',
      ylim=c(0, 1), col="red", ylab="F(x)", las=1)
curve(pPL(x, mu=1.5, sigma=0.2), col="green3", add=TRUE)
curve(pPL(x, mu=0.8, sigma=2), col="purple", add=TRUE)

cap1 <- expression(paste(mu, "=", 1, ", ", sigma, "=", 0.5))
cap2 <- expression(paste(mu, "=", 1.5, ", ", sigma, "=", 0.2))
cap3 <- expression(paste(mu, "=", 0.8, ", ", sigma, "=", 2))

legend('bottomright', legend=c(cap1, cap2, cap3), 
       col=c("red", "green3", "purple"), lty=c(1, 1, 1), bty="n")
```

### Hazard function
$$h(x) = \frac{(1 + x^{\mu})x^{\mu - 1}}{\sigma + 1 + \sigma x^{\mu}},$$ 

Next figure shows possible shapes of the hazard function.

```{r PL3, echo=FALSE}
curve(hPL(x, mu=1, sigma=1), from=0.001, to=12, las=1, xlab='Density',
      ylim=c(0, 2), col="red", ylab="h(x)", las=1)
curve(hPL(x, mu=1.5, sigma=0.2), col="green3", add=TRUE)
curve(hPL(x, mu=0.8, sigma=2), col="purple", add=TRUE)

cap1 <- expression(paste(mu, "=", 1, ", ", sigma, "=", 1))
cap2 <- expression(paste(mu, "=", 1.5, ", ", sigma, "=", 0.2))
cap3 <- expression(paste(mu, "=", 0.8, ", ", sigma, "=", 2))

legend('bottomright', legend=c(cap1, cap2, cap3), 
       col=c("red", "green3", "purple"), lty=c(1, 1, 1), bty="n")
```

## 1) Estimation parameters without covariates

### Example from Bader and Priest (1982)
The tensile strength, measured in GPa, of 69 carbon fibers tested under tension at gauge
lengths of 20 mm are in vector `y` and the objective is to find the parameters for the Power Lindley distribution. 

```{r}
y <- c(1.312, 1.314, 1.479, 1.552, 1.700, 1.803, 1.861, 1.865, 1.944, 1.958, 1.966, 1.997, 2.006, 2.021, 2.027, 2.055, 2.063, 2.098,
2.14, 2.179, 2.224, 2.240, 2.253, 2.270, 2.272, 2.274, 2.301, 2.301, 2.359, 2.382, 2.382, 2.426, 2.434, 2.435, 2.478, 2.490, 2.511,
2.514, 2.535, 2.554, 2.566, 2.57, 2.586, 2.629, 2.633, 2.642, 2.648, 2.684, 2.697, 2.726, 2.770, 2.773, 2.800, 2.809, 2.818, 2.821,
2.848, 2.88, 2.954, 3.012, 3.067, 3.084, 3.090, 3.096, 3.128, 3.233, 3.433, 3.585, 3.585)
```

To estimate the parameters for the Power Lindley distribution we use the `gamlss` function from __gamlss__ package.

```{r message=FALSE}
require(RelDists)
require(gamlss)
mod <- gamlss(y~1, sigma.fo=~1, family='PL',
              control=gamlss.control(n.cyc=1500, trace=FALSE))
```

The results for the fitted model can be found below.

```{r}
exp(coef(mod, what='mu'))
exp(coef(mod, what='sigma'))
```

In the next figure we have the histogram for the data and the fitted density. We note that the fitted density explains better the observed data.

```{r PL4}
hist(y, freq=FALSE, breaks=15, main='')
curve(dPL(x, mu=3.842, sigma=0.050), from=0.01, add=TRUE, lwd=2)
```

### Using simulated data
First, we simulate 100 values for the distribution using known parameters.

```{r}
y <- rPL(n=100, mu=1.5, sigma=0.2)
```

Now we use the `gamlss` function from __gamlss__ package to estimate the parameters.

```{r, message=FALSE}
mod <- gamlss(y~1, sigma.fo=~1, family='PL',
              control=gamlss.control(n.cyc=250, trace=FALSE))
```

To obtain the fitted values for $\mu$ and $\sigma$ we use the inverse link function $\log()$.

```{r}
exp(coef(mod, what='mu'))
exp(coef(mod, what='sigma'))
```

The results show that estimated parameters are close to the true parameters $\mu$ and $\sigma$.

In the next figure we have the histogram for the data and the fitted density. We note that the fitted density explains better the observed data.

```{r PL5}
hist(y, freq=FALSE, main='', ylim=c(0, 0.3))
curve(dPL(x, mu=exp(coef(mod, what='mu')), 
          sigma=exp(coef(mod, what='sigma'))), 
      from=0.01, add=TRUE, lwd=2)
```

## 2) Estimation parameters with covariates
Here we generate values from a Power Lindley distribution using the next model.

\begin{align*} 
y &\sim PL(\mu_i, \sigma_i), \\ 
\log(\mu_i) &= 1.2 - 2 \times x_1, \\
\log(\sigma_i) &= 0.8 - 3 \times x_2, \\
x_1 &\sim U(0, 1), \\
x_2 &\sim U(0, 1)
\end{align*}

The code below can be used to generate $n=200$ from the last model.

```{r}
n <- 200
x1 <- runif(n, min=0.4, max=0.6)
x2 <- runif(n, min=0.4, max=0.6)
mu <- exp(1.2 - 2 * x1)
sigma <- exp(0.8 - 3 * x2)
x <- rPL(n=n, mu, sigma)
```

To estimate the parameters $\mu$, $\sigma$ and $\nu$ we can use the next code.

```{r}
mod <- gamlss(x~x1, sigma.fo=~x2, family=PL,
              control=gamlss.control(n.cyc=5000, trace=FALSE))
```

and the results can be found with

```{r}
coef(mod, what="mu")
coef(mod, what="sigma")
```

We note that the estimated parameters are close to the true parameter vector $\boldsymbol{\theta} = (1.2, -2, 0.8, -3)^\top$.
